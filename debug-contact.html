<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Form Debug</title>
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <style>
        body {
            background-color: #f8f9fa !important;
            color: #333 !important;
        }
        
        .debug-info {
            background: #fff !important;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
            color: #333 !important;
        }
        
        .debug-info h4 {
            color: #495057 !important;
            margin-bottom: 10px;
        }
        
        .debug-info p {
            color: #333 !important;
        }
        
        .debug-info pre {
            background: #f8f9fa !important;
            border: 1px solid #dee2e6;
            border-radius: 3px;
            padding: 10px;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            color: #333 !important;
        }
        
        .test-form {
            background: #fff !important;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
            color: #333 !important;
        }
        
        .test-form label {
            color: #333 !important;
            font-weight: 500;
        }
        
        .form-control {
            background-color: #fff !important;
            color: #333 !important;
            border: 1px solid #ced4da !important;
        }
        
        .form-control:focus {
            background-color: #fff !important;
            color: #333 !important;
            border-color: #80bdff !important;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
        }
        
        .btn-primary {
            background-color: #007bff !important;
            border-color: #007bff !important;
            color: #fff !important;
        }
        
        .btn-primary:hover {
            background-color: #0056b3 !important;
            border-color: #0056b3 !important;
        }
        
        .alert {
            color: #333 !important;
        }
        
        .alert-success {
            background-color: #d4edda !important;
            border-color: #c3e6cb !important;
            color: #155724 !important;
        }
        
        .alert-danger {
            background-color: #f8d7da !important;
            border-color: #f5c6cb !important;
            color: #721c24 !important;
        }
        
        .alert-info {
            background-color: #d1ecf1 !important;
            border-color: #bee5eb !important;
            color: #0c5460 !important;
        }
        
        h1, h2, h3, h4, h5, h6 {
            color: #333 !important;
        }
        
        ol, ul {
            color: #333 !important;
        }
        
        li {
            color: #333 !important;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1>Contact Form Debug Page</h1>
        
        <div class="debug-info">
            <h4>Server Information</h4>
            <div id="serverInfo">Loading...</div>
        </div>
        
        <div class="debug-info">
            <h4>PHP Mail Test</h4>
            <div id="mailTest">Loading...</div>
        </div>
        
        <div class="debug-info">
            <h4>Debug Log</h4>
            <div id="debugLog">Loading...</div>
        </div>
        
        <div class="test-form">
            <h4>Test Contact Form</h4>
            <form id="testContactForm">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label>Name:</label>
                            <input type="text" name="name" class="form-control" value="Test User" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label>Email:</label>
                            <input type="email" name="email" class="form-control" value="test@example.com" required>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label>Subject:</label>
                            <input type="text" name="subject" class="form-control" value="Test Subject" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label>Phone:</label>
                            <input type="text" name="phone_number" class="form-control" value="1234567890" required>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Message:</label>
                    <textarea name="message" class="form-control" rows="3" required>This is a test message from the debug page.</textarea>
                </div>
                <button type="submit" class="btn btn-primary">Test Submit</button>
            </form>
            <div id="testResult" class="mt-3"></div>
        </div>
        
        <div class="debug-info">
            <h4>Instructions</h4>
            <ol>
                <li>Check the server information above</li>
                <li>Verify PHP mail function is available</li>
                <li>Submit the test form above</li>
                <li>Check the debug log for any errors</li>
                <li>Check your email inbox for the test message</li>
            </ol>
        </div>
    </div>

    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script>
        $(document).ready(function() {
            // Test basic PHP connectivity first
            $.get('simple-test.php', function(data) {
                $('#serverInfo').html('<div class="alert alert-success">✓ PHP is working! ' + data.message + '</div>');
                
                // Now load server information
                $.get('test-contact.php', function(data) {
                    $('#serverInfo').append(data);
                }).fail(function() {
                    $('#serverInfo').append('<div class="alert alert-warning">Could not load detailed server info, but PHP is working.</div>');
                });
            }).fail(function() {
                $('#serverInfo').html('<div class="alert alert-danger">✗ PHP is not working or simple-test.php is not accessible. Check your server configuration.</div>');
            });
            
            // Load debug log
            $.get('contact_debug.log', function(data) {
                $('#debugLog').html('<pre>' + data + '</pre>');
            }).fail(function() {
                $('#debugLog').html('<p style="color: orange;">No debug log found yet. Submit the form to generate logs.</p>');
            });
            
            // Test contact handler accessibility first
            $.get('contact-handler.php', function(data) {
                $('#testResult').html('<div class="alert alert-info">Contact handler is accessible. Testing form submission...</div>');
            }).fail(function(xhr, status, error) {
                $('#testResult').html('<div class="alert alert-danger">✗ Contact handler not accessible. Error: ' + status + ' - ' + error + '<br>Status Code: ' + xhr.status + '</div>');
            });
            
            // Test form submission
            $('#testContactForm').on('submit', function(e) {
                e.preventDefault();
                
                var formData = {
                    name: $('input[name="name"]').val(),
                    email: $('input[name="email"]').val(),
                    subject: $('input[name="subject"]').val(),
                    phone_number: $('input[name="phone_number"]').val(),
                    message: $('textarea[name="message"]').val()
                };
                
                $('#testResult').html('<div class="alert alert-info">Sending test message...</div>');
                
                $.ajax({
                    url: 'contact-handler.php',
                    type: 'POST',
                    data: formData,
                    dataType: 'json',
                    success: function(response) {
                        if (response.success) {
                            $('#testResult').html('<div class="alert alert-success">✓ ' + response.message + '</div>');
                        } else {
                            $('#testResult').html('<div class="alert alert-danger">✗ ' + response.message + '</div>');
                        }
                        
                        // Reload debug log
                        setTimeout(function() {
                            $.get('contact_debug.log', function(data) {
                                $('#debugLog').html('<pre>' + data + '</pre>');
                            });
                        }, 1000);
                    },
                    error: function(xhr, status, error) {
                        $('#testResult').html('<div class="alert alert-danger">✗ AJAX Error: ' + status + ' - ' + error + '</div>');
                        console.error('AJAX Error:', xhr, status, error);
                    }
                });
            });
        });
    </script>
</body>
</html>
